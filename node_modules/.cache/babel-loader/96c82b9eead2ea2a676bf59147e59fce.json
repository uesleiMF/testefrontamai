{"ast":null,"code":"var _jsxFileName = \"/home/ues/Documentos/GitHub/testefrontamai/src/Dashboard.js\";\nimport React, { Component } from 'react';\nimport { Button, TextField, Dialog, DialogActions, DialogTitle, DialogContent, TableBody, Table, TableContainer, TableHead, TableRow, TableCell, CircularProgress } from '@material-ui/core';\nimport { Pagination } from '@material-ui/lab';\nimport swal from 'sweetalert';\nimport axios from 'axios';\nimport pdfMake from \"pdfmake/build/pdfmake\";\nimport pdfFonts from \"pdfmake/build/vfs_fonts\";\nimport \"./Dashboard.css\";\npdfMake.vfs = pdfFonts.pdfMake.vfs;\nexport default class Dashboard extends Component {\n  constructor() {\n    super();\n    this._isMounted = false;\n\n    this.componentDidMount = () => {\n      this._isMounted = true;\n      const token = localStorage.getItem('token');\n\n      if (!token) {\n        this.props.history.push('/login');\n      } else {\n        if (this._isMounted) this.setState({\n          token\n        }, () => this.getCasal());\n      }\n    };\n\n    this.getAuthHeaders = () => {\n      const t = this.state.token || localStorage.getItem('token');\n      if (!t) return {};\n      return {\n        Authorization: `Bearer ${t}`,\n        token: t\n      };\n    };\n\n    this.getCasal = async () => {\n      if (this._isMounted) this.setState({\n        loading: true\n      });\n\n      try {\n        var _ref, _res$data$casais, _res$data, _res$data2, _ref2, _res$data$pages, _res$data3, _res$data4;\n\n        let data = `?page=${this.state.page}`;\n        if (this.state.search) data += `&search=${encodeURIComponent(this.state.search)}`;\n        const res = await axios.get(`https://backtestmar.onrender.com/get-casal${data}`, {\n          headers: this.getAuthHeaders()\n        });\n        const casais = (_ref = (_res$data$casais = (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.casais) !== null && _res$data$casais !== void 0 ? _res$data$casais : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.casal) !== null && _ref !== void 0 ? _ref : [];\n        const pages = (_ref2 = (_res$data$pages = (_res$data3 = res.data) === null || _res$data3 === void 0 ? void 0 : _res$data3.pages) !== null && _res$data$pages !== void 0 ? _res$data$pages : (_res$data4 = res.data) === null || _res$data4 === void 0 ? void 0 : _res$data4.totalPages) !== null && _ref2 !== void 0 ? _ref2 : 1;\n        if (this._isMounted) this.setState({\n          loading: false,\n          casais,\n          pages\n        });\n      } catch (err) {\n        var _err$response, _err$response$data;\n\n        const msg = (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.errorMessage) || err.message || 'Erro ao buscar casais';\n        swal({\n          text: msg,\n          icon: \"error\"\n        });\n        if (this._isMounted) this.setState({\n          loading: false,\n          casais: [],\n          pages: 0\n        });\n      }\n    };\n\n    this.deleteCasal = async id => {\n      if (!window.confirm('Tem certeza que deseja excluir este casal?')) return;\n\n      try {\n        var _res$data5;\n\n        const headers = {\n          'Content-Type': 'application/json',\n          ...this.getAuthHeaders()\n        };\n        let res;\n\n        try {\n          res = await axios.delete(`https://backtestmar.onrender.com/delete-casal/${id}`, {\n            headers\n          });\n        } catch (e) {\n          res = await axios.post('https://backtestmar.onrender.com/delete-casal', {\n            id\n          }, {\n            headers\n          });\n        }\n\n        swal({\n          text: ((_res$data5 = res.data) === null || _res$data5 === void 0 ? void 0 : _res$data5.title) || 'Deletado com sucesso!',\n          icon: \"success\"\n        });\n        if (this._isMounted) this.setState({\n          page: 1\n        }, () => this.getCasal());\n      } catch (err) {\n        var _err$response2, _err$response2$data;\n\n        const msg = (err === null || err === void 0 ? void 0 : (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.errorMessage) || err.message || 'Erro ao deletar';\n        swal({\n          text: msg,\n          icon: \"error\"\n        });\n      }\n    };\n\n    this.pageChange = (e, page) => {\n      if (this._isMounted) this.setState({\n        page\n      }, () => this.getCasal());\n    };\n\n    this.logOut = () => {\n      localStorage.removeItem('token');\n      this.props.history.push('/');\n    };\n\n    this.onChange = e => {\n      if (e.target.files && e.target.files[0]) {\n        const file = e.target.files[0];\n        if (this._isMounted) this.setState({\n          fileName: file.name,\n          filePreview: URL.createObjectURL(file)\n        });\n        return;\n      }\n\n      const {\n        name,\n        value\n      } = e.target;\n\n      if (this._isMounted) {\n        this.setState({\n          [name]: value\n        }, () => {\n          if (name === 'search') {\n            this.setState({\n              page: 1\n            }, () => this.getCasal());\n          }\n        });\n      }\n    };\n\n    this.addCasal = async () => {\n      const fileInput = this.fileInputAddRef.current;\n\n      if (!fileInput || !fileInput.files[0]) {\n        return swal({\n          text: 'Selecione uma imagem',\n          icon: 'error'\n        });\n      }\n\n      if (!this.state.name || !this.state.desc || !this.state.tel || !this.state.niverH || !this.state.niverM) {\n        return swal({\n          text: 'Preencha todos os campos',\n          icon: 'error'\n        });\n      }\n\n      const fd = new FormData();\n      fd.append('file', fileInput.files[0]);\n      fd.append('name', this.state.name);\n      fd.append('desc', this.state.desc);\n      fd.append('tel', this.state.tel);\n      fd.append('niverH', this.state.niverH);\n      fd.append('niverM', this.state.niverM);\n\n      try {\n        var _res$data6;\n\n        const res = await axios.post('https://backtestmar.onrender.com/add-casal', fd, {\n          headers: {\n            'content-type': 'multipart/form-data',\n            ...this.getAuthHeaders()\n          }\n        });\n        swal({\n          text: ((_res$data6 = res.data) === null || _res$data6 === void 0 ? void 0 : _res$data6.message) || 'Casal adicionado!',\n          icon: \"success\"\n        });\n\n        if (this._isMounted) {\n          this.handleCasalClose();\n          this.setState({\n            name: '',\n            desc: '',\n            tel: '',\n            niverH: '',\n            niverM: '',\n            fileName: '',\n            filePreview: '',\n            page: 1\n          }, () => this.getCasal());\n        }\n\n        if (fileInput) fileInput.value = null;\n      } catch (err) {\n        var _err$response3, _err$response3$data;\n\n        const msg = (err === null || err === void 0 ? void 0 : (_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.errorMessage) || err.message || 'Erro ao adicionar';\n        swal({\n          text: msg,\n          icon: \"error\"\n        });\n        this.handleCasalClose();\n      }\n    };\n\n    this.updateCasal = async () => {\n      const fileInput = this.fileInputEditRef.current;\n      const id = this.state.id;\n      if (!id) return swal({\n        text: 'ID ausente',\n        icon: 'error'\n      });\n\n      if (!this.state.name || !this.state.desc || !this.state.tel || !this.state.niverH || !this.state.niverM) {\n        return swal({\n          text: 'Preencha os campos',\n          icon: 'error'\n        });\n      }\n\n      const fd = new FormData();\n      fd.append('name', this.state.name);\n      fd.append('desc', this.state.desc);\n      fd.append('tel', this.state.tel);\n      fd.append('niverH', this.state.niverH);\n      fd.append('niverM', this.state.niverM);\n\n      if (fileInput && fileInput.files[0]) {\n        fd.append('file', fileInput.files[0]);\n      }\n\n      try {\n        var _res$data7;\n\n        const res = await axios.put(`https://backtestmar.onrender.com/update-casal/${id}`, fd, {\n          headers: {\n            'content-type': 'multipart/form-data',\n            ...this.getAuthHeaders()\n          }\n        });\n        swal({\n          text: ((_res$data7 = res.data) === null || _res$data7 === void 0 ? void 0 : _res$data7.message) || 'Atualizado!',\n          icon: 'success'\n        });\n\n        if (this._isMounted) {\n          this.handleCasaltEditClose();\n          this.setState({\n            name: '',\n            desc: '',\n            tel: '',\n            niverH: '',\n            niverM: '',\n            fileName: ''\n          }, () => this.getCasal());\n        }\n\n        if (fileInput) fileInput.value = null;\n      } catch (err) {\n        var _err$response4, _err$response4$data;\n\n        const msg = (err === null || err === void 0 ? void 0 : (_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.errorMessage) || err.message || 'Erro';\n        swal({\n          text: msg,\n          icon: 'error'\n        });\n        this.handleCasaltEditClose();\n      }\n    };\n\n    this.handleCasalOpen = () => {\n      this.setState({\n        openCasalModal: true,\n        id: '',\n        name: '',\n        desc: '',\n        tel: '',\n        niverH: '',\n        niverM: '',\n        fileName: '',\n        filePreview: ''\n      });\n      if (this.fileInputAddRef.current) this.fileInputAddRef.current.value = null;\n    };\n\n    this.handleCasalClose = () => {\n      this.setState({\n        openCasalModal: false\n      });\n    };\n\n    this.handleCasalEditOpen = data => {\n      var _data$niverH, _data$niverM;\n\n      this.setState({\n        openCasalEditModal: true,\n        id: data._id,\n        name: data.name,\n        desc: data.desc,\n        tel: data.tel,\n        niverH: (_data$niverH = data.niverH) === null || _data$niverH === void 0 ? void 0 : _data$niverH.substring(0, 10),\n        niverM: (_data$niverM = data.niverM) === null || _data$niverM === void 0 ? void 0 : _data$niverM.substring(0, 10),\n        fileName: data.image,\n        filePreview: data.image\n      });\n      if (this.fileInputEditRef.current) this.fileInputEditRef.current.value = null;\n    };\n\n    this.handleCasaltEditClose = () => {\n      this.setState({\n        openCasalEditModal: false\n      });\n    };\n\n    this.generateTablePDF = async () => {\n      const {\n        casais\n      } = this.state;\n      const body = [[\"Imagem\", \"Nome\", \"Descrição\", \"Telefone\", \"Aniv. H\", \"Aniv. M\"]];\n\n      for (let casal of casais) {\n        var _casal$niverH, _casal$niverM;\n\n        let imgBase64 = casal.image || \"\";\n        body.push([imgBase64 ? {\n          image: imgBase64,\n          width: 50,\n          height: 50\n        } : '—', casal.name || '', casal.desc || '', casal.tel || '', ((_casal$niverH = casal.niverH) === null || _casal$niverH === void 0 ? void 0 : _casal$niverH.substring(0, 10)) || '', ((_casal$niverM = casal.niverM) === null || _casal$niverM === void 0 ? void 0 : _casal$niverM.substring(0, 10)) || '']);\n      }\n\n      const docDefinition = {\n        content: [{\n          text: 'Casais - Tabela',\n          style: 'header'\n        }, {\n          table: {\n            headerRows: 1,\n            widths: ['auto', '*', '*', '*', 'auto', 'auto'],\n            body\n          }\n        }],\n        styles: {\n          header: {\n            fontSize: 18,\n            bold: true,\n            marginBottom: 10\n          }\n        }\n      };\n      pdfMake.createPdf(docDefinition).download('casais_tabela.pdf');\n    };\n\n    this.generateCardsPDF = async () => {\n      const {\n        casais\n      } = this.state;\n      const cards = casais.map(casal => {\n        var _casal$niverH2, _casal$niverM2;\n\n        return {\n          stack: [casal.image ? {\n            image: casal.image,\n            width: 150,\n            height: 150\n          } : '', {\n            text: casal.name,\n            style: 'casalName'\n          }, {\n            text: casal.desc || '',\n            style: 'casalDesc'\n          }, {\n            text: casal.tel || '',\n            style: 'casalTel'\n          }, {\n            text: `Aniv. H: ${((_casal$niverH2 = casal.niverH) === null || _casal$niverH2 === void 0 ? void 0 : _casal$niverH2.substring(0, 10)) || '-'}`,\n            style: 'casalDates'\n          }, {\n            text: `Aniv. M: ${((_casal$niverM2 = casal.niverM) === null || _casal$niverM2 === void 0 ? void 0 : _casal$niverM2.substring(0, 10)) || '-'}`,\n            style: 'casalDates'\n          }, {\n            text: '-----------------------------'\n          }],\n          marginBottom: 10\n        };\n      });\n      const docDefinition = {\n        content: [{\n          text: 'Casais - Cartões',\n          style: 'header'\n        }, ...cards],\n        styles: {\n          header: {\n            fontSize: 18,\n            bold: true,\n            marginBottom: 10\n          },\n          casalName: {\n            fontSize: 16,\n            bold: true,\n            marginTop: 5\n          },\n          casalDesc: {\n            fontSize: 12\n          },\n          casalTel: {\n            fontSize: 12\n          },\n          casalDates: {\n            fontSize: 12,\n            italics: true\n          }\n        }\n      };\n      pdfMake.createPdf(docDefinition).download('casais_cartoes.pdf');\n    };\n\n    this.state = {\n      token: null,\n      openCasalModal: false,\n      openCasalEditModal: false,\n      id: '',\n      name: '',\n      desc: '',\n      tel: '',\n      niverH: '',\n      niverM: '',\n      fileName: '',\n      filePreview: '',\n      page: 1,\n      search: '',\n      casais: [],\n      pages: 0,\n      loading: false\n    };\n    this.fileInputAddRef = React.createRef();\n    this.fileInputEditRef = React.createRef();\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  // ===================== FIM PDF =====================\n  render() {\n    const {\n      casais,\n      loading,\n      page,\n      pages,\n      filePreview\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"dashboard-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 7\n      }\n    }, loading && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loading-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      color: \"inherit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"top-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 11\n      }\n    }, \"CELULAS DE CASAIS\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      size: \"small\",\n      onClick: this.handleCasalOpen,\n      className: \"btn-space\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 13\n      }\n    }, \"Adicionar Casais\"), /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"secondary\",\n      size: \"small\",\n      onClick: this.generateTablePDF,\n      className: \"btn-space\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 13\n      }\n    }, \"Baixar PDF (Tabela)\"), /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"secondary\",\n      size: \"small\",\n      onClick: this.generateCardsPDF,\n      className: \"btn-space\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 13\n      }\n    }, \"Baixar PDF (Cart\\xF5es)\"), /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      size: \"small\",\n      onClick: this.logOut,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 13\n      }\n    }, \"Sair\"))));\n  }\n\n}","map":{"version":3,"sources":["/home/ues/Documentos/GitHub/testefrontamai/src/Dashboard.js"],"names":["React","Component","Button","TextField","Dialog","DialogActions","DialogTitle","DialogContent","TableBody","Table","TableContainer","TableHead","TableRow","TableCell","CircularProgress","Pagination","swal","axios","pdfMake","pdfFonts","vfs","Dashboard","constructor","_isMounted","componentDidMount","token","localStorage","getItem","props","history","push","setState","getCasal","getAuthHeaders","t","state","Authorization","loading","data","page","search","encodeURIComponent","res","get","headers","casais","casal","pages","totalPages","err","msg","response","errorMessage","message","text","icon","deleteCasal","id","window","confirm","delete","e","post","title","pageChange","logOut","removeItem","onChange","target","files","file","fileName","name","filePreview","URL","createObjectURL","value","addCasal","fileInput","fileInputAddRef","current","desc","tel","niverH","niverM","fd","FormData","append","handleCasalClose","updateCasal","fileInputEditRef","put","handleCasaltEditClose","handleCasalOpen","openCasalModal","handleCasalEditOpen","openCasalEditModal","_id","substring","image","generateTablePDF","body","imgBase64","width","height","docDefinition","content","style","table","headerRows","widths","styles","header","fontSize","bold","marginBottom","createPdf","download","generateCardsPDF","cards","map","stack","casalName","marginTop","casalDesc","casalTel","casalDates","italics","createRef","componentWillUnmount","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n  Button, TextField, Dialog, DialogActions,\n  DialogTitle, DialogContent, TableBody, Table,\n  TableContainer, TableHead, TableRow, TableCell, CircularProgress,\n} from '@material-ui/core';\nimport { Pagination } from '@material-ui/lab';\nimport swal from 'sweetalert';\nimport axios from 'axios';\nimport pdfMake from \"pdfmake/build/pdfmake\";\nimport pdfFonts from \"pdfmake/build/vfs_fonts\";\nimport \"./Dashboard.css\";\n\npdfMake.vfs = pdfFonts.pdfMake.vfs;\n\nexport default class Dashboard extends Component {\n  _isMounted = false;\n\n  constructor() {\n    super();\n    this.state = {\n      token: null,\n      openCasalModal: false,\n      openCasalEditModal: false,\n      id: '',\n      name: '',\n      desc: '',\n      tel: '',\n      niverH: '',\n      niverM: '',\n      fileName: '',\n      filePreview: '',\n      page: 1,\n      search: '',\n      casais: [],\n      pages: 0,\n      loading: false\n    };\n\n    this.fileInputAddRef = React.createRef();\n    this.fileInputEditRef = React.createRef();\n  }\n\n  componentDidMount = () => {\n    this._isMounted = true;\n    const token = localStorage.getItem('token');\n    if (!token) {\n      this.props.history.push('/login');\n    } else {\n      if (this._isMounted) this.setState({ token }, () => this.getCasal());\n    }\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  getAuthHeaders = () => {\n    const t = this.state.token || localStorage.getItem('token');\n    if (!t) return {};\n    return { Authorization: `Bearer ${t}`, token: t };\n  }\n\n  getCasal = async () => {\n    if (this._isMounted) this.setState({ loading: true });\n    try {\n      let data = `?page=${this.state.page}`;\n      if (this.state.search) data += `&search=${encodeURIComponent(this.state.search)}`;\n      const res = await axios.get(`https://backtestmar.onrender.com/get-casal${data}`, {\n        headers: this.getAuthHeaders()\n      });\n\n      const casais = res.data?.casais ?? res.data?.casal ?? [];\n      const pages = res.data?.pages ?? res.data?.totalPages ?? 1;\n\n      if (this._isMounted) this.setState({ loading: false, casais, pages });\n    } catch (err) {\n      const msg = err?.response?.data?.errorMessage || err.message || 'Erro ao buscar casais';\n      swal({ text: msg, icon: \"error\" });\n      if (this._isMounted) this.setState({ loading: false, casais: [], pages: 0 });\n    }\n  }\n\n  deleteCasal = async (id) => {\n    if (!window.confirm('Tem certeza que deseja excluir este casal?')) return;\n    try {\n      const headers = { 'Content-Type': 'application/json', ...this.getAuthHeaders() };\n      let res;\n\n      try {\n        res = await axios.delete(`https://backtestmar.onrender.com/delete-casal/${id}`, { headers });\n      } catch (e) {\n        res = await axios.post('https://backtestmar.onrender.com/delete-casal', { id }, { headers });\n      }\n\n      swal({ text: res.data?.title || 'Deletado com sucesso!', icon: \"success\" });\n      if (this._isMounted) this.setState({ page: 1 }, () => this.getCasal());\n    } catch (err) {\n      const msg = err?.response?.data?.errorMessage || err.message || 'Erro ao deletar';\n      swal({ text: msg, icon: \"error\" });\n    }\n  }\n\n  pageChange = (e, page) => {\n    if (this._isMounted) this.setState({ page }, () => this.getCasal());\n  }\n\n  logOut = () => {\n    localStorage.removeItem('token');\n    this.props.history.push('/');\n  }\n\n  onChange = (e) => {\n    if (e.target.files && e.target.files[0]) {\n      const file = e.target.files[0];\n      if (this._isMounted) this.setState({\n        fileName: file.name,\n        filePreview: URL.createObjectURL(file)\n      });\n      return;\n    }\n\n    const { name, value } = e.target;\n\n    if (this._isMounted) {\n      this.setState({ [name]: value }, () => {\n        if (name === 'search') {\n          this.setState({ page: 1 }, () => this.getCasal());\n        }\n      });\n    }\n  };\n\n  addCasal = async () => {\n    const fileInput = this.fileInputAddRef.current;\n\n    if (!fileInput || !fileInput.files[0]) {\n      return swal({ text: 'Selecione uma imagem', icon: 'error' });\n    }\n\n    if (!this.state.name || !this.state.desc || !this.state.tel || !this.state.niverH || !this.state.niverM) {\n      return swal({ text: 'Preencha todos os campos', icon: 'error' });\n    }\n\n    const fd = new FormData();\n    fd.append('file', fileInput.files[0]);\n    fd.append('name', this.state.name);\n    fd.append('desc', this.state.desc);\n    fd.append('tel', this.state.tel);\n    fd.append('niverH', this.state.niverH);\n    fd.append('niverM', this.state.niverM);\n\n    try {\n      const res = await axios.post('https://backtestmar.onrender.com/add-casal', fd, {\n        headers: { 'content-type': 'multipart/form-data', ...this.getAuthHeaders() }\n      });\n\n      swal({ text: res.data?.message || 'Casal adicionado!', icon: \"success\" });\n\n      if (this._isMounted) {\n        this.handleCasalClose();\n        this.setState({\n          name: '', desc: '', tel: '', niverH: '', niverM: '',\n          fileName: '', filePreview: '', page: 1\n        }, () => this.getCasal());\n      }\n\n      if (fileInput) fileInput.value = null;\n    } catch (err) {\n      const msg = err?.response?.data?.errorMessage || err.message || 'Erro ao adicionar';\n      swal({ text: msg, icon: \"error\" });\n      this.handleCasalClose();\n    }\n  };\n\n  updateCasal = async () => {\n    const fileInput = this.fileInputEditRef.current;\n    const id = this.state.id;\n\n    if (!id) return swal({ text: 'ID ausente', icon: 'error' });\n\n    if (!this.state.name || !this.state.desc || !this.state.tel || !this.state.niverH || !this.state.niverM) {\n      return swal({ text: 'Preencha os campos', icon: 'error' });\n    }\n\n    const fd = new FormData();\n    fd.append('name', this.state.name);\n    fd.append('desc', this.state.desc);\n    fd.append('tel', this.state.tel);\n    fd.append('niverH', this.state.niverH);\n    fd.append('niverM', this.state.niverM);\n\n    if (fileInput && fileInput.files[0]) {\n      fd.append('file', fileInput.files[0]);\n    }\n\n    try {\n      const res = await axios.put(\n        `https://backtestmar.onrender.com/update-casal/${id}`,\n        fd,\n        { headers: { 'content-type': 'multipart/form-data', ...this.getAuthHeaders() } }\n      );\n\n      swal({ text: res.data?.message || 'Atualizado!', icon: 'success' });\n\n      if (this._isMounted) {\n        this.handleCasaltEditClose();\n        this.setState({\n          name: '', desc: '', tel: '', niverH: '', niverM: '', fileName: ''\n        }, () => this.getCasal());\n      }\n\n      if (fileInput) fileInput.value = null;\n    } catch (err) {\n      const msg = err?.response?.data?.errorMessage || err.message || 'Erro';\n      swal({ text: msg, icon: 'error' });\n      this.handleCasaltEditClose();\n    }\n  };\n\n  handleCasalOpen = () => {\n    this.setState({\n      openCasalModal: true,\n      id: '', name: '', desc: '', tel: '', niverH: '', niverM: '',\n      fileName: '', filePreview: ''\n    });\n    if (this.fileInputAddRef.current) this.fileInputAddRef.current.value = null;\n  };\n\n  handleCasalClose = () => {\n    this.setState({ openCasalModal: false });\n  };\n\n  handleCasalEditOpen = (data) => {\n    this.setState({\n      openCasalEditModal: true,\n      id: data._id,\n      name: data.name,\n      desc: data.desc,\n      tel: data.tel,\n      niverH: data.niverH?.substring(0, 10),\n      niverM: data.niverM?.substring(0, 10),\n      fileName: data.image,\n      filePreview: data.image\n    });\n    if (this.fileInputEditRef.current) this.fileInputEditRef.current.value = null;\n  };\n\n  handleCasaltEditClose = () => {\n    this.setState({ openCasalEditModal: false });\n  };\n\n  // ===================== PDF =====================\n\n  generateTablePDF = async () => {\n    const { casais } = this.state;\n\n    const body = [\n      [\"Imagem\", \"Nome\", \"Descrição\", \"Telefone\", \"Aniv. H\", \"Aniv. M\"]\n    ];\n\n    for (let casal of casais) {\n      let imgBase64 = casal.image || \"\";\n      body.push([\n        imgBase64 ? { image: imgBase64, width: 50, height: 50 } : '—',\n        casal.name || '',\n        casal.desc || '',\n        casal.tel || '',\n        casal.niverH?.substring(0,10) || '',\n        casal.niverM?.substring(0,10) || ''\n      ]);\n    }\n\n    const docDefinition = {\n      content: [\n        { text: 'Casais - Tabela', style: 'header' },\n        {\n          table: {\n            headerRows: 1,\n            widths: ['auto','*','*','*','auto','auto'],\n            body\n          }\n        }\n      ],\n      styles: {\n        header: { fontSize: 18, bold: true, marginBottom: 10 }\n      }\n    };\n\n    pdfMake.createPdf(docDefinition).download('casais_tabela.pdf');\n  };\n\n  generateCardsPDF = async () => {\n    const { casais } = this.state;\n\n    const cards = casais.map(casal => {\n      return {\n        stack: [\n          casal.image ? { image: casal.image, width: 150, height: 150 } : '',\n          { text: casal.name, style: 'casalName' },\n          { text: casal.desc || '', style: 'casalDesc' },\n          { text: casal.tel || '', style: 'casalTel' },\n          { text: `Aniv. H: ${casal.niverH?.substring(0,10) || '-'}`, style: 'casalDates' },\n          { text: `Aniv. M: ${casal.niverM?.substring(0,10) || '-'}`, style: 'casalDates' },\n          { text: '-----------------------------' }\n        ],\n        marginBottom: 10\n      };\n    });\n\n    const docDefinition = {\n      content: [\n        { text: 'Casais - Cartões', style: 'header' },\n        ...cards\n      ],\n      styles: {\n        header: { fontSize: 18, bold: true, marginBottom: 10 },\n        casalName: { fontSize: 16, bold: true, marginTop: 5 },\n        casalDesc: { fontSize: 12 },\n        casalTel: { fontSize: 12 },\n        casalDates: { fontSize: 12, italics: true }\n      }\n    };\n\n    pdfMake.createPdf(docDefinition).download('casais_cartoes.pdf');\n  };\n\n  // ===================== FIM PDF =====================\n\n  render() {\n    const { casais, loading, page, pages, filePreview } = this.state;\n\n    return (\n      <div className=\"dashboard-container\">\n\n        {loading && (\n          <div className=\"loading-container\">\n            <CircularProgress color=\"inherit\" />\n          </div>\n        )}\n\n        <div className=\"top-bar\">\n          <h2>CELULAS DE CASAIS</h2>\n          <div>\n            <Button variant=\"contained\" color=\"primary\" size=\"small\" onClick={this.handleCasalOpen} className=\"btn-space\">\n              Adicionar Casais\n            </Button>\n\n            <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.generateTablePDF} className=\"btn-space\">\n              Baixar PDF (Tabela)\n            </Button>\n\n            <Button variant=\"contained\" color=\"secondary\" size=\"small\" onClick={this.generateCardsPDF} className=\"btn-space\">\n              Baixar PDF (Cartões)\n            </Button>\n\n            <Button variant=\"contained\" size=\"small\" onClick={this.logOut}>Sair</Button>\n          </div>\n        </div>\n\n        {/* ... O resto do seu código de modais e tabela continua igual ... */}\n\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}